### Configuration
@baseUrl = http://localhost:3000/api
@controller = membres

# ==========================================
# üß™ FICHIER DE TEST ‚Äî Module Membres
# ==========================================
# S√©quence de test compl√®te :
#   1. G√©n√©rer un num√©ro de compte
#   2. Cr√©er un membre avec donn√©es dynamiques
#   3. Simuler un log d'activit√© admin
#   4. V√©rifier la cr√©ation via GET filtr√©
# ==========================================

# ==========================================
# üìã 0. √âTAT INITIAL ‚Äî Lister tous les membres
# ==========================================

### R√©cup√©rer tous les membres
GET {{baseUrl}}/{{controller}}
Content-Type: application/json

###

### Statistiques globales des membres
GET {{baseUrl}}/{{controller}}/stats
Content-Type: application/json

###

# ==========================================
# üî¢ 1. G√âN√âRER UN NUM√âRO DE COMPTE
# ==========================================

### G√©n√©rer le prochain num√©ro disponible (section √âpargne)
GET {{baseUrl}}/{{controller}}/generate-numero?year=2026&section=E
Content-Type: application/json

###

### R√©cup√©rer le dernier num√©ro utilis√©
GET {{baseUrl}}/{{controller}}/last-numero?year=2026&section=E
Content-Type: application/json

###

# ==========================================
# üë§ 2. CR√âER UN MEMBRE (Donn√©es dynamiques)
# ==========================================

### Cr√©er un nouveau membre avec timestamp unique
# Le {{$timestamp}} g√©n√®re un entier Unix unique pour √©viter les doublons
POST {{baseUrl}}/{{controller}}
Content-Type: application/json

{
  "numeroCompte": "COOP-E-2026-TEST-{{$timestamp}}",
  "nomComplet": "Jean Mutombo Test",
  "dateAdhesion": "{{$datetime iso8601}}",
  "telephone": "0991234567",
  "email": "jean.test.{{$timestamp}}@mwangaza.cd",
  "adresse": "Avenue Bukavu, Goma",
  "sexe": "M",
  "typeCompte": "Epargne",
  "statut": "actif",
  "userId": "test-{{$timestamp}}",
  "motDePasse": "Test1234",
  "dateNaissance": "1990-05-15T00:00:00.000Z",
  "idNationale": "CD-NK-{{$timestamp}}",
  "montantInitial": 50,
  "deviseInitial": "USD",
  "delegue": {
    "nom": "Marie Kasongo",
    "telephone": "0997654321",
    "relation": "√âpouse"
  }
}

###

# ==========================================
# üìù 3. SIMULER UN LOG D'ACTIVIT√â ADMIN
# ==========================================
# Ce log enregistre l'action de cr√©ation du membre
# Le timestamp est d√©cal√© de -30 secondes pour simuler une action tr√®s r√©cente

### Enregistrer un log d'activit√© (cr√©ation membre)
POST {{baseUrl}}/admin/confirm
Content-Type: application/json

{
  "adminId": 1,
  "confirmationCode": "CREATE-MEMBER-{{$timestamp}}"
}

###

# ==========================================
# üîç 4. V√âRIFICATIONS ‚Äî Confirmer la cr√©ation
# ==========================================

### R√©cup√©rer le membre par son num√©ro de compte
# Remplacez COOP-E-2026-TEST-XXXXXXX par le num√©ro renvoy√© √† l'√©tape 2
GET {{baseUrl}}/{{controller}}/by-numero/COOP-E-2026-TEST-XXXXXXX
Content-Type: application/json

###

### V√©rifier que le userId n'est pas dupliqu√©
GET {{baseUrl}}/{{controller}}/check-userid/test-{{$timestamp}}
Content-Type: application/json

###

### R√©cup√©rer tous les num√©ros de compte (vue simplifi√©e)
GET {{baseUrl}}/{{controller}}/numeros
Content-Type: application/json

###

### Statistiques apr√®s cr√©ation (v√©rifier que le total a augment√©)
GET {{baseUrl}}/{{controller}}/stats
Content-Type: application/json

###

# ==========================================
# ‚úèÔ∏è 5. MODIFIER LE MEMBRE CR√â√â
# ==========================================

### Mettre √† jour le membre (remplacer :id par l'ID r√©el)
PUT {{baseUrl}}/{{controller}}/1
Content-Type: application/json

{
  "telephone": "0998877665",
  "adresse": "Avenue des Volcans, Goma",
  "statut": "actif"
}

###

# ==========================================
# üóëÔ∏è 6. NETTOYAGE ‚Äî Supprimer le membre de test
# ==========================================

### ‚ö†Ô∏è Supprimer le membre cr√©√© (remplacer :id par l'ID r√©el)
 DELETE {{baseUrl}}/{{controller}}/1
 Content-Type: application/json

###

# ==========================================
# üë• 7. D√âL√âGU√âS
# ==========================================

### Trouver un d√©l√©gu√© par son userId
GET {{baseUrl}}/delegues/by-userid/test-delegue
Content-Type: application/json
